# https://github.com/lcyh/actions-gh-pages#%EF%B8%8F-set-ssh-private-key-deploy_key
# å·¥ä½œæµåç§°ï¼Œä¸è®¾ç½®çš„è¯é»˜è®¤å–é…ç½®æ–‡ä»¶å
name: Build and Deploy
# æŒ‡å®šè§¦å‘ workflow çš„æ¡ä»¶
# æŒ‡å®šè§¦å‘äº‹ä»¶æ—¶ï¼Œå¯ä»¥é™å®šåˆ†æ”¯æˆ–æ ‡ç­¾
# å½“å‰æ˜¯ åªæœ‰ masteråˆ†æ”¯ä¸Šè§¦å‘ push äº‹ä»¶æ—¶æ‰æ‰§è¡Œå·¥ä½œæµä»»åŠ¡
on:
  push:
    branches:
      - master
# å·¥ä½œæµæ‰§è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ªä»»åŠ¡
jobs:
  # ä»»åŠ¡åç§°
  build-and-deploy:
    # ä»»åŠ¡è¿è¡Œçš„å®¹å™¨ç±»å‹ï¼ˆè™šæ‹Ÿæœºç¯å¢ƒï¼‰
    runs-on: ubuntu-latest
    # ä»»åŠ¡æ‰§è¡Œçš„æ­¥éª¤
    steps:
      # æ­¥éª¤åç§°
      - name: Checkout ğŸ›ï¸
        # ä½¿ç”¨çš„æ“ä½œ actionsï¼Œå¯ä»¥ä½¿ç”¨å…¬å…±ä»“åº“ï¼Œæœ¬åœ°ä»“åº“ï¼Œåˆ«äººçš„ä»“åº“çš„action
        # æ‹‰å–ä»£ç 
        uses: actions/checkout@v2
        with:
          persist-credentials: false

        # è®¾ç½®Nodeç¯å¢ƒ actions/setup-node@v1 æ˜¯GitHub Marketplaceå…¶ä¸­çš„ä¸€ä¸ª,ç›¸å½“äºä¸€ä¸ªæ–¹æ³•
        # ä½¿ç”¨ä¸€ä¸ªActions ä½¿ç”¨useså…³é”®å­—,  withè¡¨æ˜å‚æ•°
      - name: Setup Node.js v14.x
        uses: actions/setup-node@v1
        with:
          node-version: "14.x"

      - name: Install and Build
        run: |
          yarn
          yarn build

      - name: Deploy
        # æ„å»ºå‘å¸ƒ Github pages
        uses: peaceiris/actions-gh-pages@v3
        with:
            # github_token: ${{ secrets.VUE3_DEPLOY }}
            personal_token: ${{ secrets.VUE3_DEPLOY_TOKEN }}
            publish_dir: ./dist
            commit_message: ${{ github.event.head_commit.message }}
