{"remainingRequest":"/Users/luochang/Desktop/vue3-project/node_modules/babel-loader/lib/index.js!/Users/luochang/Desktop/vue3-project/node_modules/ts-loader/index.js??ref--14-2!/Users/luochang/Desktop/vue3-project/node_modules/eslint-loader/index.js??ref--13-0!/Users/luochang/Desktop/vue3-project/src/store/modules/databoard/index.ts","dependencies":[{"path":"/Users/luochang/Desktop/vue3-project/src/store/modules/databoard/index.ts","mtime":1630324103739},{"path":"/Users/luochang/Desktop/vue3-project/node_modules/cache-loader/dist/cjs.js","mtime":1611888872654},{"path":"/Users/luochang/Desktop/vue3-project/node_modules/babel-loader/lib/index.js","mtime":1607827004578},{"path":"/Users/luochang/Desktop/vue3-project/node_modules/ts-loader/index.js","mtime":1608712855794},{"path":"/Users/luochang/Desktop/vue3-project/node_modules/eslint-loader/index.js","mtime":1611891883494}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy9sdW9jaGFuZy9EZXNrdG9wL3Z1ZTMtcHJvamVjdC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0IHsgRWxNZXNzYWdlIH0gZnJvbSAnZWxlbWVudC1wbHVzJzsKaW1wb3J0IERhdGFib2FyZEFjdGlvbiBmcm9tICdAL2FwaS9tb2R1bGVzL2RhdGFib2FyZCc7IC8vIOagueaNrueUqOaIt+eci+adv+adg+mZkOeUn+aIkOebuOW6lOeahOWvvOiIquWIl+ihqAovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQoKZnVuY3Rpb24gZm9ybWF0TWVudVJlcG9ydChkYXRhKSB7CiAgdmFyIHJlY3Vyc2lvbiA9IGZ1bmN0aW9uIHJlY3Vyc2lvbihsaXN0KSB7CiAgICB2YXIgcmVzdWx0ID0gW107CiAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgLy8g5LiA57qn5a+86IiqCiAgICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChyZWN1cnNpb24oaXRlbS5jaGlsZHJlbikpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdC5wdXNoKFtpdGVtLm5hbWUsIGl0ZW0ucmVwb3J0VXJsXSk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICB2YXIgcmVwb3J0TWVudSA9IHJlY3Vyc2lvbihkYXRhKTsKICB2YXIgcmVwb3J0TWFwID0gbmV3IE1hcCgpOwogIHJlcG9ydE1lbnUuZm9yRWFjaChmdW5jdGlvbiAoX3JlZikgewogICAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMiksCiAgICAgICAga2V5ID0gX3JlZjJbMF0sCiAgICAgICAgdmFsdWUgPSBfcmVmMlsxXTsKCiAgICByZXR1cm4gcmVwb3J0TWFwLnNldChrZXksIHZhbHVlKTsKICB9KTsKICByZXR1cm4gcmVwb3J0TWFwOwp9Cgp2YXIgZGF0YWJvYXJkTW9kdWxlID0gewogIHN0YXRlOiB7CiAgICBnYW1lTGlzdDogW10sCiAgICBzZWxlY3RlZEdhbWU6IG51bGwsCiAgICByZXBvcnRNYXA6IG5ldyBNYXAoKSAvLyDmiYDmnInmiqXooajliJfooagKCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9HQU1FX0xJU1Q6IGZ1bmN0aW9uIFNFVF9HQU1FX0xJU1Qoc3RhdGUsIHZhbHVlKSB7CiAgICAgIHN0YXRlLmdhbWVMaXN0ID0gdmFsdWU7CiAgICB9LAogICAgU0VUX1NFTEVDVEVEX0dBTUU6IGZ1bmN0aW9uIFNFVF9TRUxFQ1RFRF9HQU1FKHN0YXRlLCB2YWx1ZSkgewogICAgICBzdGF0ZS5zZWxlY3RlZEdhbWUgPSB2YWx1ZTsKICAgIH0sCiAgICBTRVRfUkVQT1JUX0xJU1Q6IGZ1bmN0aW9uIFNFVF9SRVBPUlRfTElTVChzdGF0ZSwgbGlzdCkgewogICAgICBjb25zb2xlLmxvZygnU0VUX1JFUE9SVF9MSVNUJywgbGlzdCk7CiAgICAgIHZhciBtZW51cyA9IGZvcm1hdE1lbnVSZXBvcnQobGlzdCk7CiAgICAgIGNvbnNvbGUubG9nKCdmcmVwb3J0TWFwJywgbWVudXMpOwogICAgICBzdGF0ZS5yZXBvcnRNYXAgPSBtZW51czsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIHNldFNlbGVjdGVkR2FtZTogZnVuY3Rpb24gc2V0U2VsZWN0ZWRHYW1lKF9yZWYzLCB2YWx1ZSkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgICAgdmFyIGN1cnJlbnRHYW1lID0gc3RhdGUuZ2FtZUxpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmdhbWVCYXNlSWQgPT09IHZhbHVlOwogICAgICB9KTsKCiAgICAgIGlmIChjdXJyZW50R2FtZSkgewogICAgICAgIGNvbW1pdCgnU0VUX1NFTEVDVEVEX0dBTUUnLCBjdXJyZW50R2FtZSk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRHYW1lTGlzdDogZnVuY3Rpb24gc2V0R2FtZUxpc3QoX3JlZjQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjQuc3RhdGU7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgRGF0YWJvYXJkQWN0aW9uLmdldEdhbWVMaXN0KCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBpZiAocmVzLmRhdGEpIHsKICAgICAgICAgICAgdmFyIGRhdGEgPSByZXMuZGF0YTsKICAgICAgICAgICAgdmFyIGRlZmF1bHRHYW1lID0gc3RhdGUuc2VsZWN0ZWRHYW1lOwoKICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgaWYgKCFzdGF0ZS5zZWxlY3RlZEdhbWUpIHsKICAgICAgICAgICAgICAgIGRlZmF1bHRHYW1lID0gZGF0YVswXSB8fCBudWxsOwogICAgICAgICAgICAgICAgY29tbWl0KCdTRVRfU0VMRUNURURfR0FNRScsIGRlZmF1bHRHYW1lKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbW1pdCgnU0VUX0dBTUVfTElTVCcsIGRhdGEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXNvbHZlKGRlZmF1bHRHYW1lKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ+a4uOaIj+aVsOaNruiOt+WPluWksei0pScpKTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICB2YXIgbXNnID0gZXJyLm1lc3NhZ2UgfHwgJ+ivt+axguW8guW4uCc7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IobXNnKTsKICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBzZXRSZXBvcnRMaXN0OiBmdW5jdGlvbiBzZXRSZXBvcnRMaXN0KF9yZWY1LCB2YWx1ZSkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjUuY29tbWl0LAogICAgICAgICAgZ2V0dGVycyA9IF9yZWY1LmdldHRlcnM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgRGF0YWJvYXJkQWN0aW9uLmdldFJlcG9ydExpc3QoewogICAgICAgICAgdXNlcklkOiBnZXR0ZXJzLnVzZXJJbmZvLmlkLAogICAgICAgICAgZ2FtZUJhc2VJZDogdmFsdWUKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgICAgICB2YXIgZGF0YSA9IHJlcy5kYXRhOyAvLyDnlJ/miJDmiqXooajlt6bkvqflr7zoiKoKCiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JFUE9SVF9MSVNUJywgZGF0YSk7CiAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ+a4uOaIj+aKpeihqOiOt+WPluWksei0pScpKTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICB2YXIgbXNnID0gZXJyLm1lc3NhZ2UgfHwgJ+ivt+axguW8guW4uCc7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IobXNnKTsKICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IGRhdGFib2FyZE1vZHVsZTs="},{"version":3,"sources":["/Users/luochang/Desktop/vue3-project/node_modules/eslint-loader/index.js??ref--13-0!/Users/luochang/Desktop/vue3-project/src/store/modules/databoard/index.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ActionContext } from 'vuex'\nimport { ElMessage } from 'element-plus'\nimport DataBoardState, { , GameInfo, DataboardMenu } from './types'\nimport DataboardAction from '@/api/modules/databoard'\nimport RootStateTypes from '../../types'\n\n// 根据用户看板权限生成相应的导航列表\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction formatMenuReport(data: any[]) {\n  const recursion = (list: DataboardMenu[]): string[][] => {\n    let result: string[][] = []\n    list.forEach((item: DataboardMenu) => {\n      // 一级导航\n      if (item.children && item.children.length) {\n        result = result.concat(recursion(item.children))\n      } else {\n        result.push([item.name, item.reportUrl])\n      }\n    })\n    return result\n  }\n  const reportMenu = recursion(data)\n  const reportMap = new Map()\n  reportMenu.forEach(([key, value]) => reportMap.set(key, value))\n  return reportMap\n}\n\nconst databoardModule = {\n  state: {\n    gameList: [], // 游戏列表\n    selectedGame: null, // 选中的游戏\n    reportMap: new Map() // 所有报表列表\n  },\n  mutations: {\n    SET_GAME_LIST(state: DataBoardState, value: GameInfo[]) {\n      state.gameList = value\n    },\n    SET_SELECTED_GAME(state: DataBoardState, value: GameInfo) {\n      state.selectedGame = value\n    },\n    SET_REPORT_LIST(state: DataBoardState, list: []) {\n      console.log('SET_REPORT_LIST', list)\n      const menus = formatMenuReport(list)\n      console.log('freportMap', menus)\n\n      state.reportMap = menus\n    }\n  },\n  actions: {\n    setSelectedGame({ commit, state }: ActionContext<DataBoardState, RootStateTypes>, value: string) {\n      const currentGame = state.gameList.find((item) => item.gameBaseId === value)\n      if (currentGame) {\n        commit('SET_SELECTED_GAME', currentGame)\n      }\n    },\n    setGameList({ commit, state }: ActionContext<DataBoardState, RootStateTypes>) {\n      return new Promise<GameInfo>((resolve, reject) => {\n        DataboardAction.getGameList().then((res) => {\n          if (res.data) {\n            const { data } = res\n            let defaultGame = state.selectedGame\n            if (data.length) {\n              if (!state.selectedGame) {\n                defaultGame = data[0] || null\n                commit('SET_SELECTED_GAME', (defaultGame))\n              }\n              commit('SET_GAME_LIST', data)\n            }\n            resolve(defaultGame)\n          } else {\n            reject(new Error('游戏数据获取失败'))\n          }\n        }).catch((err) => {\n          const msg = err.message || '请求异常'\n          ElMessage.error(msg)\n          reject(err)\n        })\n      })\n    },\n    setReportList({ commit, getters }: ActionContext<string, RootStateTypes>, value: number) {\n      return new Promise<void>((resolve, reject) => {\n        DataboardAction.getReportList({\n          userId: getters.userInfo.id,\n          gameBaseId: value\n        }).then((res) => {\n          if (res.data) {\n            const { data } = res\n            // 生成报表左侧导航\n            commit('SET_REPORT_LIST', data)\n            resolve()\n          } else {\n            reject(new Error('游戏报表获取失败'))\n          }\n        }).catch((err) => {\n          const msg = err.message || '请求异常'\n          ElMessage.error(msg)\n          reject(err)\n        })\n      })\n    }\n  }\n}\n\nexport default databoardModule\n"],"sourceRoot":""}]}